<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>core/lib/img.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="$api.module_color.html">color</a></li><li><a href="$api.module_img.html">img</a><ul class='methods'><li data-type='method'><a href="$api.module_img.html#~base64">base64</a></li><li data-type='method'><a href="$api.module_img.html#~load">load</a></li></ul></li><li><a href="$api.module_linq.html">linq</a></li><li><a href="$api.module_math.html">math</a></li><li><a href="$api.module_money.html">money</a><ul class='methods'><li data-type='method'><a href="$api.module_money.html#~formatColumn">formatColumn</a></li><li data-type='method'><a href="$api.module_money.html#~formatMoney">formatMoney</a></li><li data-type='method'><a href="$api.module_money.html#~formatNumber">formatNumber</a></li><li data-type='method'><a href="$api.module_money.html#~unformat">unformat</a></li><li data-type='method'><a href="$api.module_money.html#~unit">unit</a></li></ul></li><li><a href="$api.module_os.html">os</a></li><li><a href="$api.module_qs.html">qs</a></li><li><a href="$api.module_storage.html">storage</a><ul class='methods'><li data-type='method'><a href="$api.module_storage.html#~del">del</a></li><li data-type='method'><a href="$api.module_storage.html#~get">get</a></li><li data-type='method'><a href="$api.module_storage.html#~set">set</a></li></ul></li><li><a href="$api.module_string.html">string</a><ul class='methods'><li data-type='method'><a href="$api.module_string.html#~break">break</a></li><li data-type='method'><a href="$api.module_string.html#~byteLength">byteLength</a></li><li data-type='method'><a href="$api.module_string.html#~clearHtml">clearHtml</a></li><li data-type='method'><a href="$api.module_string.html#~html2Text">html2Text</a></li><li data-type='method'><a href="$api.module_string.html#~unique">unique</a></li></ul></li><li><a href="$api.module_type.html">type</a><ul class='methods'><li data-type='method'><a href="$api.module_type.html#~add">add</a></li><li data-type='method'><a href="$api.module_type.html#~isArray">isArray</a></li><li data-type='method'><a href="$api.module_type.html#~isBoolean">isBoolean</a></li><li data-type='method'><a href="$api.module_type.html#~isDate">isDate</a></li><li data-type='method'><a href="$api.module_type.html#~isError">isError</a></li><li data-type='method'><a href="$api.module_type.html#~isFunction">isFunction</a></li><li data-type='method'><a href="$api.module_type.html#~isNaN">isNaN</a></li><li data-type='method'><a href="$api.module_type.html#~isNull">isNull</a></li><li data-type='method'><a href="$api.module_type.html#~isNumber">isNumber</a></li><li data-type='method'><a href="$api.module_type.html#~isObject">isObject</a></li><li data-type='method'><a href="$api.module_type.html#~isPlainObject">isPlainObject</a></li><li data-type='method'><a href="$api.module_type.html#~isRegExp">isRegExp</a></li><li data-type='method'><a href="$api.module_type.html#~isString">isString</a></li><li data-type='method'><a href="$api.module_type.html#~isUndefined">isUndefined</a></li><li data-type='method'><a href="$api.module_type.html#~isWindow">isWindow</a></li></ul></li><li><a href="$plus.module_back.html">back</a><ul class='methods'><li data-type='method'><a href="$plus.module_back.html#~add">add</a></li><li data-type='method'><a href="$plus.module_back.html#~remove">remove</a></li></ul></li><li><a href="$plus.module_clip.html">clip</a><ul class='methods'><li data-type='method'><a href="$plus.module_clip.html#~read">read</a></li><li data-type='method'><a href="$plus.module_clip.html#~write">write</a></li></ul></li><li><a href="$plus.module_img.html">img</a><ul class='methods'><li data-type='method'><a href="$plus.module_img.html#~capture">capture</a></li><li data-type='method'><a href="$plus.module_img.html#~compress">compress</a></li><li data-type='method'><a href="$plus.module_img.html#~pick">pick</a></li><li data-type='method'><a href="$plus.module_img.html#~save">save</a></li></ul></li><li><a href="$plus.module_msg.html">msg</a><ul class='methods'><li data-type='method'><a href="$plus.module_msg.html#~send">send</a></li></ul></li><li><a href="$plus.module_ui.html">ui</a><ul class='methods'><li data-type='method'><a href="$plus.module_ui.html#~beginPullRefresh">beginPullRefresh</a></li><li data-type='method'><a href="$plus.module_ui.html#~closeWaiting">closeWaiting</a></li><li data-type='method'><a href="$plus.module_ui.html#~pullRefresh">pullRefresh</a></li><li data-type='method'><a href="$plus.module_ui.html#~showWaiting">showWaiting</a></li><li data-type='method'><a href="$plus.module_ui.html#~toast">toast</a></li></ul></li><li><a href="$plus.module_win.html">win</a><ul class='methods'><li data-type='method'><a href="$plus.module_win.html#~all">all</a></li><li data-type='method'><a href="$plus.module_win.html#~close">close</a></li><li data-type='method'><a href="$plus.module_win.html#~create">create</a></li><li data-type='method'><a href="$plus.module_win.html#~get">get</a></li><li data-type='method'><a href="$plus.module_win.html#~getTop">getTop</a></li><li data-type='method'><a href="$plus.module_win.html#~goHome">goHome</a></li><li data-type='method'><a href="$plus.module_win.html#~hide">hide</a></li><li data-type='method'><a href="$plus.module_win.html#~home">home</a></li><li data-type='method'><a href="$plus.module_win.html#~id">id</a></li><li data-type='method'><a href="$plus.module_win.html#~isHome">isHome</a></li><li data-type='method'><a href="$plus.module_win.html#~isTop">isTop</a></li><li data-type='method'><a href="$plus.module_win.html#~menu">menu</a></li><li data-type='method'><a href="$plus.module_win.html#~open">open</a></li><li data-type='method'><a href="$plus.module_win.html#~openBrowser">openBrowser</a></li><li data-type='method'><a href="$plus.module_win.html#~show">show</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="$api.html">$api</a><ul class='methods'><li data-type='method'><a href="$api.html#.mix">mix</a></li></ul></li><li><a href="$plus.html">$plus</a><ul class='methods'><li data-type='method'><a href="$plus.html#.errorPage">errorPage</a></li><li data-type='method'><a href="$plus.html#.winStyle">winStyle</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">core/lib/img.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * 相册，拍照，压缩图片，保存图片
 * @module img
 * @memberof $plus
 * @summary 相册，拍照，压缩图片
 */

let img = {}

/**
 * 从系统相册选择文件（图片或视频）
 * 从系统相册中选择图片或视频文件。每次仅能选择一个文件，选择后将返回选择的文件路径。
 * @public
 * @function pick
 * @param {object} options http://www.html5plus.org/doc/zh_cn/gallery.html#plus.gallery.GalleryOptions
 * @return {Promise}
 * @example
 * $plus.img.pick({
 *  // 系统相册选择器中可选择的文件类型，可设置为仅选择图片文件（“image”）、视频文件（“video”）或所有文件（“none”），默认值为“image”
 *  filter: 'image',
 *  // 是否支持多选图片
 *  multiple: false,
 *  // 仅在支持多选时有效，取值范围为1到Infinity，默认值为Infinity，即不限制选择的图片数。 如果设置的值非法则使用默认值Infinity。
 *  maximum: 1
 * }).then(files => {
 *  // 文件数组
 *  console.log(files.length)
 * }).catch(err => {
 *  console.log(err)
 * })
 */
img.pick = function(options) {
  if (window.plus) {
    options = options || {}
    return new Promise(function(resolve, reject) {
      plus.gallery.pick(
        function(e) {
          let files = []
          if (e &amp;&amp; e.files) {
            files = e.files
          } else {
            files.push(e)
          }
          resolve(files)
        },
        reject,
        options
      )
    })
  } else {
    return new Promise(function(resolve, reject) {
      reject('error')
    })
  }
}

// let pick = (success, error, options) => {
//   if (window.plus) {
//     options = options || {}
//     window.plus.gallery.pick(function (e) {
//       let files = []
//       if (e &amp;&amp; e.files) {
//         files = e.files
//       } else {
//         files.push(e)
//       }
//       success(files)
//     }, function (err) {
//       error(err)
//     }, options)
//   }
// }

/**
 * 进行拍照操作
 * 摄像头资源为独占资源，如果其它程序或页面已经占用摄像头，再次操作则失败。 拍照操作成功将通过successCB返回拍照获取的图片路径。 可通过option设置摄像头的各种属性参数。
 * @public
 * @function capture
 * @param {object} options http://www.html5plus.org/doc/zh_cn/camera.html#plus.camera.CameraOption
 * @return {Promise}
 * @example
 * $plus.img.capture({
 *  // 拍照或摄像文件保存的路径
 *  filename: '_doc/camera/'
 * }).then(file => {
 *  console.log(file)
 * }).catch(err => {
 *  console.log(err)
 * })
 */
img.capture = function(options) {
  if (window.plus) {
    options = options || {}
    let cmr = window.plus.camera.getCamera()
    return new Promise(function(resolve, reject) {
      cmr.captureImage(resolve, reject, options)
    })
  } else {
    return new Promise(function(resolve, reject) {
      reject('error')
    })
  }
}

// let captureImage = (success, error, options) => {
//   if (window.plus) {
//     options = options || {}
//     let cmr = window.plus.camera.getCamera()
//     cmr.captureImage(
//       function(file) {
//         success(file)
//       },
//       function(err) {
//         error(err)
//       },
//       options
//     )
//   }
// }

/**
 * 图片压缩转换
 * 可用于图片的质量压缩、大小缩放、方向旋转、区域裁剪、格式转换等。
 * @public
 * @function compress
 * @param {object} options http://www.html5plus.org/doc/zh_cn/zip.html#plus.zip.CompressImageOptions
 * @return {Promise}
 * @example
 * let name = file.substr(file.lastIndexOf('/') + 1)
 * $plus.img.compress({
 *  // 压缩转换原始图片的路径
 *  src: file,
 *  // 压缩转换目标图片的路径
 *  dst: '_doc/' + name,
 *  // 是否覆盖生成新文件
 *  overwrite: true,
 *  // 压缩图片的质量，取值范围为1-100，1表示使用最低的图片质量（转换后的图片文件最小）、100表示使用最高的图片质量（转换后的图片文件最大）； 默认值为50。
 *  quality: 75,
 *  // 缩放图片的宽度，支持像素值（如"100px"）、百分比（如"50%"）、自动计算（如"auto"，即根据height与源图高的缩放比例计算，若未设置height则使用源图高度）； 默认值为"auto"。 注意：若设置了width属性值不合法（如"0px"），则不对图片进行缩放操作。
 *   width: 600,
 *  // 缩放图片的高度，支持像素值（如"100px"）、百分比（如"50%"）、自动计算（如"auto"，即根据width与源图宽的缩放比例计算，若未设置width则使用源图高度）； 默认值为"auto"。 注意：若设置了height属性值不合法（如"0px"），则不对图片进行缩放操作。
 *  height: 'auto'
 * }).then(zip => {
 *  // 图片路径
 *  console.log(zip.target)
 * }).catch(err => {
 *  console.log(err)
 * })
 */
img.compress = function(options) {
  if (window.plus) {
    options = options || {}
    return new Promise(function(resolve, reject) {
      window.plus.zip.compressImage(options, resolve, reject)
    })
  } else {
    return new Promise(function(resolve, reject) {
      reject('error')
    })
  }
}
// let compressImage = (options, success, error) => {
//   if (window.plus) {
//     options = options || {}
//     window.plus.zip.compressImage(
//       options,
//       function(zip) {
//         success(zip)
//       },
//       function(err) {
//         error(err)
//       }
//     )
//   }
// }
/**
 * 保存文件到系统相册中。
 * 每次仅能保存一个文件，支持图片类型（jpg/jpeg、png、bmp等格式）和视频文件（3gp、mov等格式）。 若保存的文件系统不支持，则通过errorCB返回错误信息。
 * @public
 * @function save
 * @param {string} path 要保存到系统相册中的文件文件地址
 * @return {Promise}
 * @example
 * $plus.img.save(path).then(file => {
 *  // 成功回调：www.html5plus.org/doc/zh_cn/gallery.html#plus.gallery.GallerySuccessCallback
 * }).catch(err => {
 *  // 失败回调：www.html5plus.org/doc/zh_cn/gallery.html#plus.gallery.GalleryErrorCallback
 * })
 */
img.save = function(path) {
  if (window.plus) {
    return new Promise(function(resolve, reject) {
      plus.gallery.save(path, resolve, reject)
    })
  }
}

if (!window.$plus.img) {
  Object.defineProperty(window.$plus, 'img', {
    configurable: false,
    enumerable: false,
    Writable: false,
    get: function() {
      return img
    }
  })
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Tue Nov 19 2019 10:16:03 GMT+0800 (GMT+08:00) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
